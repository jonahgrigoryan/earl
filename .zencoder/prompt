I need you to expand this Zencoder M3 implementation guide into a comprehensive 5,000+ line version with FULL detailed prompts for all 24 tasks.

ATTACHED FILE: .zencoder/zen_prompts_m3.md (the streamlined version)

YOUR TASK:
Expand this guide by writing COMPLETE, COPY-PASTE-READY prompts for Tasks 2-24 following the EXACT pattern shown for Task 1 (lines 44-85).

For EACH task (2-24), generate TWO sections:
1. **Coding Agent Prompt** (following Task 1's structure at lines 44-66)
2. **Unit Testing Agent Prompt** (following Task 1's structure at lines 68-85)

Use these source specs as references:
- `.kiro/specs/rpea-m3/tasks.md` — Task descriptions, acceptance criteria, expected diff
- `.kiro/specs/rpea-m3/design.md` — Implementation details (data models, interfaces, formulas)
- `.kiro/specs/rpea-m3/requirements.md` — Acceptance criteria details
- `finalspec.md` — Overall spec constraints

STRUCTURE FOR EACH TASK:
Task X: [Task Name] (Coding Agent)
Attach: [relevant files from design.md/requirements.md]
[Prompt block with:
GOAL from tasks.md
Implementation details from design.md (structs, methods, formulas)
Integration points
Config additions if any
Style constraints
Acceptance criteria
Expected line count]
Task X: Unit Tests (Unit Testing Agent)
Attach: [impl file + test_framework.mqh]
[Prompt block with:
File name
5-7 test cases covering acceptance criteria
Test wrapper function]
INCLUDE HOLD POINT AUDIT PROMPTS:
- HOLD POINT 2 (after Task 6): Q&A Agent audit for retry policy & market fallback
- HOLD POINT 3 (after Task 9): Q&A Agent audit for atomics/OCO/partial fills
- HOLD POINT 4 (after Task 11): Q&A Agent audit for budget gate/news CSV

EXAMPLES TO FOLLOW:
- Task 1 Coding Agent prompt (lines 47-66) shows the format
- Task 1 Unit Testing prompt (lines 71-85) shows test structure
- HOLD POINT 1 audit (lines 88-99) shows Q&A format

CRITICAL DETAILS TO INCLUDE PER TASK:
- Task 2 (Idempotency): intent_id/action_id generation, JSON schema from design.md lines 223-259
- Task 5 (Retry Policy): Error code mapping table from design.md lines 315-333
- Task 7 (Atomics): Counter-order rollback logic from design.md lines 343-377
- Task 8 (OCO): OCORelationship struct from design.md lines 262-277
- Task 10 (Budget Gate): Formula & snapshot logic from design.md lines 446-473
- Task 12-15 (Synthetics): Full XAUEUR formulas from finalspec.md lines 157-188
- Task 18 (Audit Logging): Complete CSV schema from design.md lines 568-612

OUTPUT FORMAT:
- Keep Phase 1 and Phase 3 sections unchanged
- Replace "TASK REFERENCE (2-24)" section (lines 103-117) with FULL task prompts
- Maintain all markdown formatting, code blocks, tables
- Total output should be 4,500-6,000 lines

START OUTPUT with the complete file from line 1, including all existing content plus expansions.
